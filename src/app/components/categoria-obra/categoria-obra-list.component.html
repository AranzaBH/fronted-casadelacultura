<div class="bootstrap-wrapper">
  <div class="container mt-4 p-3 bg-white shadow-sm rounded" style="max-width: 750px;">


    <div *ngIf="message" [ngClass]="{'alert-success': messageType === 'success', 'alert-danger': messageType === 'error'}" class="alert mt-3">
      {{ message }}
    </div>

        <div class="row mt-3">
          <div class="col text-center">
            <h1 class="text-center w-100">Categoria Obra</h1>
            <hr class="w-100" />
          </div>
        </div>

        <div class="row">
          <div class="col-12 col-md-12">
            <div class="input-group">
              <input #search type="text" [(ngModel)]="params.filtro" (ngModelChange)="onSearch()"
                placeholder="Buscar por nombre o descripción" class="form-control form-control-lg border-0 shadow-sm" />
              <span class="input-group-text border-0" style="background-color: #9D2449; color: rgb(237, 235, 235);">
                <img src="assets/busqueda.png" alt="Buscar" style="width: 20px; height: 20px; object-fit: contain;" />
              </span>
            </div>
          </div>
        </div>

        <div class="row mt-3">
          <div class="col-12 col-md-6 text-md-left">
            <!-- Imagen como botón de agregar tipo taller -->
<button (click)="abrirForm()" class="btn btn-lg px-5 shadow-sm btn-hover"
  style="display: flex; align-items: center; justify-content: center; width: auto; margin: 0 auto 10px 50; text-align: center;">
  <img src="assets/agregar.png" alt="Agregar Categoría"
    style="width: 20px; height: 20px; object-fit: contain; margin-right: 5px;" />
  Categoria
</button>




          </div>


          <div class="table-responsive">
            <p-table #tablaB [value]="listaCategoria" [paginator]="true" [rows]="10" [totalRecords]="params.total"
              [lazy]="true" (onLazyLoad)="mPaginacion($event)" [first]="params.offset"
              [loading]="!listaCategoria.length" [rows]="5" [rowsPerPageOptions]="[5,10,20,50,100]" sortMode="multiple"
              [responsive]="true" class="table table-bordered table-hover shadow-sm">

              <ng-template pTemplate="header">
                <tr class="bg-light text-center">
                  <th>Nombre</th>
                  <th>Descripción</th>
                  <th>Acciones</th>
                </tr>
              </ng-template>

              <ng-template pTemplate="body" let-categoria>
                <tr>
                  <td>{{ categoria.nombre}}</td>
                  <td>{{ categoria.descripcion }}</td>
                  <td class="text-center">
                    <button (click)="editar(categoria)" class="btn btn-sm"
                      style="background-color: #28a745; color: white;" title="Editar">
                      <i class="pi pi-pencil"></i> Editar
                    </button>

                    <button (click)="confirmDelete(categoria)" class="btn btn-danger btn-sm"
                      style="background-color: #9D2449; color: white;" title="Eliminar">
                      <i class="pi pi-trash"></i> Eliminar
                    </button>
                  </td>
                </tr>
              </ng-template>

              <ng-template pTemplate="paginator">
                <div class="pagination-container">
                  <p-paginator [rows]="10" [totalRecords]="params.total" [first]="params.offset"
                    (onPageChange)="mPaginacion($event)" [showCurrentPageReport]="true"
                    [rowsPerPageOptions]="[10, 20, 50]" class="p-jc-center"></p-paginator>
                </div>
              </ng-template>

            </p-table>

          </div>

        </div>
      </div>
    </div>



  <p-dialog [(visible)]="categoriaDialog" [modal]="true" [closable]="false" [responsive]="true"
    [style]="{ width: '50vw' }">
    <div class="d-flex justify-content-between align-items-center">
      <h5 class="mb-0">Editar</h5>
      <button type="button" class="btn btn-sm btn-close" (click)="cerrarForm()" aria-label="Cerrar">
        <i class="pi pi-times"></i>
      </button>
    </div>

    <app-categoria-obra-form [categoriaObra]="selectCategoria"
      (categoriaObraChange)="cerrarForm()"></app-categoria-obra-form>
  </p-dialog>

  <p-dialog [(visible)]="deleteDialog" [modal]="true" [closable]="false" header="Confirmar Eliminación"
  [contentStyle]="{ 'background-color': '#fff', 'padding': '20px', 'border-radius': '8px' }"
  [style]="{ 'width': '30vw', 'box-shadow': '0 4px 20px rgba(0,0,0,0.2)', 'border-radius': '8px' }">

  <ng-template pTemplate="header">
    <div class="custom-dialog-header" style="background-color: #f8f9fa; color: #333; font-size: 18px; font-weight: 600; padding: 15px; border-top-left-radius: 8px; border-top-right-radius: 8px;">
      Confirmar Eliminación
    </div>
  </ng-template>

  <div class="p-dialog-content" style="font-size: 16px; color: #444; padding: 10px 0;">
    <p>¿Está seguro de que desea eliminar la categoria <strong>{{ selectCategoria?.nombre }}</strong>?</p>
  </div>

  <div class="p-dialog-footer" style="display: flex; justify-content: flex-end; padding: 10px;">
    <button (click)="delete()" class="btn btn-danger" style="margin-right: 10px; padding: 8px 20px; font-size: 14px; border-radius: 4px;">
      Eliminar
    </button>
    <button (click)="deleteDialog = false" class="btn btn-secondary" style="padding: 8px 20px; font-size: 14px; border-radius: 4px;">
      Cancelar
    </button>
  </div>
</p-dialog>

